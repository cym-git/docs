# css基础

## css加载会造成阻塞吗
> js加载会造成 *DOM* 树的解析和渲染

### css加载会造成DOM树的阻塞嘛？
- 首先，*css* 加载会阻塞 *DOM* 树渲染，但是 *css* 并不会阻塞 *DOM* 树的解析
- 也就是说，你可以在 *css* 加载完之前可以在 *js* 中获取到 *DOM* 元素，但是 *DOM* 却是没有渲染到页面上，需要等到 *css* 加载完毕才渲染
- 为什么会这样？
  - 在你加载 *css* 的时候，可能会修改 *DOM* 节点的样式，如果 *css* 加载不阻塞 *DOM* 树渲染的话，那么当 *css* 加载完之后， *DOM* 树可有又得重绘或者回流了
  - 所以干脆先把 *DOM* 树的结构先解析完成，把可以做的工作做完，然后等你 *css* 加载完之后，再根据最终样式来渲染 *DOM* 树，这种做法性能方面确实会比较好一点。（猜测）

### css加载会阻塞js运行嘛？
- css加载会阻塞**后面的js语句**的执行

### 总结
  1. css加载不会阻塞 *DOM* 树的解析；
  2. css加载会阻塞 *DOM* 树的渲染；
  3. css加载会阻塞后面js语句的执行

### 浏览器渲染流程
- 浏览器渲染的流程如下：
  1. *html* 解析文件，生成 *DOM* 树，解析 *css* 文件生成 *CSSOM* 树
  2. 将 *DOM* 树和 *CSSOM* 树结合，生成 *Render Tree*
  3. 根据 *Render Tree* 渲染机制，将像素渲染到屏幕上
- 从浏览器渲染流程可以看出
  1. *DOM* 解析和 *CSS* 解析是两个并行的进程，所以这也解释了为什么 *css* 加载不会阻塞 *DOM* 的解析
  2. 然而，由于 *Render Tree* 是依赖与 *DOM Tree* 和 *CSSOM Tree*，所以它必须等到 *CSSOM Tree* 构建完成，也就是 *css* 资源加载完成(或者加载失败)后，才开始渲染，因此，css加载是会阻塞 *DOM* 的渲染的
  3. 由于 *js* 可能会操作之前的 *dom* 节点和 *css* 样式，因此浏览器会维持 *html* 中 *css* 和 *js* 的顺序。因此，样式表会在后面的 *js* 执行前先加载执行完毕。所以 *css* 会阻塞后面 *js* 的执行 

### DOMContentLoaded
- 对于浏览器来说，页面加载主要有两个事件，一个是 *DOMContentLoaded*，另一个是 *onLoad*
- *onload* 就是等待页面所有资源都在加载完成才会触发，这些资源包括css、js、图片视频等
- *DOMContentLoaded* 顾明思议就是当页面的**内容解析完成后**，则触发该事件
  - 如果页面中同时存在css和js，并且**js在css后面**，则 *DOMContentLoaded* 事件会在css加载完后才执行
  - 其他情况下，*DOMContentLoaded* 都不会等待css加载，并且 *DOMContentLoaded* 事件也不会等待图片、视频等其他资源加载
