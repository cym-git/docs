<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mapbox GL JS | chengyuming</title>
    <meta name="description" content="Today, have you studied yet?">
    <link rel="icon" href="/imgs/oops.png">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.0c9ad33d.css" as="style"><link rel="preload" href="/assets/js/app.bbd35a38.js" as="script"><link rel="preload" href="/assets/js/3.40b378a7.js" as="script"><link rel="preload" href="/assets/js/1.f41db50d.js" as="script"><link rel="preload" href="/assets/js/17.5aea2979.js" as="script"><link rel="prefetch" href="/assets/js/10.f4f7f506.js"><link rel="prefetch" href="/assets/js/11.d125c012.js"><link rel="prefetch" href="/assets/js/12.37a8c984.js"><link rel="prefetch" href="/assets/js/13.5805149a.js"><link rel="prefetch" href="/assets/js/14.85e0680a.js"><link rel="prefetch" href="/assets/js/15.9191ecf2.js"><link rel="prefetch" href="/assets/js/16.9ebb5559.js"><link rel="prefetch" href="/assets/js/18.696ad47e.js"><link rel="prefetch" href="/assets/js/19.a079e272.js"><link rel="prefetch" href="/assets/js/20.7a532207.js"><link rel="prefetch" href="/assets/js/21.46f02a18.js"><link rel="prefetch" href="/assets/js/4.8fbbe4ba.js"><link rel="prefetch" href="/assets/js/5.59272d5a.js"><link rel="prefetch" href="/assets/js/6.4f95ab1b.js"><link rel="prefetch" href="/assets/js/7.81114dda.js"><link rel="prefetch" href="/assets/js/8.a6fed93d.js"><link rel="prefetch" href="/assets/js/9.06ed8ddc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0c9ad33d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.jpg" alt="chengyuming" class="logo"> <span class="site-name">chengyuming</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      大前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/webpack/index.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack简介
</a></li><li class="dropdown-item"><!----> <a href="/views/webpack/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  从0搭建vue
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/index.html" class="nav-link"><i class="iconfont undefined"></i>
  node简介
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/fs.html" class="nav-link"><i class="iconfont undefined"></i>
  fs文件系统
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/backend/mysql.html" class="nav-link"><i class="iconfont undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/nginx/index.html" class="nav-link"><i class="iconfont undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/visualization/mapbox.html" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  mapbox
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-three"></i>
      基础
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/basis/javascript.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/basis/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li></ul></div></div> <a href="https://github.com/cym-git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      大前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/webpack/index.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack简介
</a></li><li class="dropdown-item"><!----> <a href="/views/webpack/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  从0搭建vue
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/index.html" class="nav-link"><i class="iconfont undefined"></i>
  node简介
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/fs.html" class="nav-link"><i class="iconfont undefined"></i>
  fs文件系统
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/backend/mysql.html" class="nav-link"><i class="iconfont undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/nginx/index.html" class="nav-link"><i class="iconfont undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/visualization/mapbox.html" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  mapbox
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-three"></i>
      基础
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/basis/javascript.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/basis/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li></ul></div></div> <a href="https://github.com/cym-git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Mapbox GL JS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/big-front-end/visualization/mapbox.html#底图渲染" class="sidebar-link">底图渲染</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/big-front-end/visualization/mapbox.html#添加控制器" class="sidebar-link">添加控制器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/big-front-end/visualization/mapbox.html#添加-移除标记" class="sidebar-link">添加/移除标记</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/big-front-end/visualization/mapbox.html#地图移动" class="sidebar-link">地图移动</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#flyto-地图飞行" class="sidebar-link">flyTo 地图飞行</a></li><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#jumpto-跳跃" class="sidebar-link">jumpTo 跳跃</a></li><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#easeto-动态转换" class="sidebar-link">easeTo 动态转换</a></li></ul></li><li><a href="/views/big-front-end/visualization/mapbox.html#layer-和-source" class="sidebar-link">Layer 和 Source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#添加-删除layer" class="sidebar-link">添加/删除Layer</a></li></ul></li><li><a href="/views/big-front-end/visualization/mapbox.html#地图事件" class="sidebar-link">地图事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#on-load事件" class="sidebar-link">on -&gt; load事件</a></li><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#on-click-事件" class="sidebar-link">on -&gt; click 事件</a></li><li class="sidebar-sub-header"><a href="/views/big-front-end/visualization/mapbox.html#改变鼠标手型" class="sidebar-link">改变鼠标手型</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>Mapbox GL JS</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>chengyuming</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2019-7-24</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      Mapbox
    </span></i></div></div> <div class="content__default"><h1 id="mapbox-gl-js"><a href="#mapbox-gl-js" aria-hidden="true" class="header-anchor">#</a> Mapbox GL JS</h1> <blockquote><p><a href="https://www.mapbox.cn/mapbox-gl-js/api/#map" target="_blank" rel="noopener noreferrer">中文版<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://docs.mapbox.com/mapbox-gl-js/api/?q=addlayer&amp;size=n_10_n" target="_blank" rel="noopener noreferrer">英文版<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="底图渲染"><a href="#底图渲染" aria-hidden="true" class="header-anchor">#</a> 底图渲染</h2> <ul><li>初次渲染地图很简单，按照官网的配置</li> <li>我们需要一个地图渲染容器，需要用到 mapbox-gl 库，有时候你可能需要准备一个开发者token，那我们开始吧</li> <li>首先我们实例化一个Map类，在mapbox-gl里面有个Map类，该类接受一个options配置对象作为初始化地图的条件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> mapboxgl <span class="token keyword">from</span> <span class="token string">'mapbox-gl'</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    container<span class="token punctuation">:</span> <span class="token string">'底图容器'</span><span class="token punctuation">,</span>
    style<span class="token punctuation">:</span> <span class="token string">'您的底图json'</span><span class="token punctuation">,</span>
    <span class="token comment">// 经度越大越靠左，纬度越大越靠下</span>
    center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">108.5</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment">// 初始化地图的中心点</span>
    zoom<span class="token punctuation">:</span> <span class="token number">3.9</span><span class="token punctuation">,</span>              <span class="token comment">// 缩放比例</span>
    bearing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>             <span class="token comment">// 地图的初始方位角（旋转度）</span>
    pitch<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">// 地图的初始倾斜度，按偏离屏幕水平面的度数计量（0-60）</span>
    doubleClickZoom<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 取消双击缩放</span>
    dragRotate<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">,</span>     <span class="token comment">// 取消地图旋转</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="添加控制器"><a href="#添加控制器" aria-hidden="true" class="header-anchor">#</a> 添加控制器</h2> <ul><li>实例map的方法，map.addControl()</li> <li>接受两个参数，<strong>要添加的控制器</strong> 和 <strong>添加的位置</strong> <em>('top-left' ,  'top-right' ,  'bottom-left' , and  'bottom-right' 。默认为  'top-right' )</em></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 添加地图导航空间（放大缩小）</span>
  map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>NavigationControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'top-left'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加比例尺</span>
  <span class="token keyword">const</span> scale <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>ScaleControl</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    maxWidth<span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
    unit<span class="token punctuation">:</span> <span class="token string">'imperial'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span>scale<span class="token punctuation">)</span>
  scale<span class="token punctuation">.</span><span class="token function">setUnit</span><span class="token punctuation">(</span><span class="token string">'metric'</span><span class="token punctuation">)</span>
  <span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="添加-移除标记"><a href="#添加-移除标记" aria-hidden="true" class="header-anchor">#</a> 添加/移除标记</h2> <ul><li>在mapbox-gl类中有Marker类，专门用来处理标记</li> <li>该类接受两个参数，element和options</li> <li>只是添加一个标记，但是添加到哪就需要你来设置了</li> <li>移除标记就是移除该类的实例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 全局可修改的marker</span>
  <span class="token keyword">let</span> marker <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">function</span> <span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token parameter">LngLat<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>marker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      marker<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span>LngLat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="地图移动"><a href="#地图移动" aria-hidden="true" class="header-anchor">#</a> 地图移动</h2> <h3 id="flyto-地图飞行"><a href="#flyto-地图飞行" aria-hidden="true" class="header-anchor">#</a> flyTo 地图飞行</h3> <ul><li>对地图中心、缩放级别、方位角和倾斜度做任意组合改变， 使其沿着一条曲线动态地变化并引发飞行效果。 该动态转换能够无缝引入缩放和平移，使用户即使在穿越了很长的距离后也能保持方位角不变</li> <li>接收两个参数， <strong>options</strong>和<strong>传递的其他属性</strong></li> <li><strong>options.curve</strong> [number] (default 1.42)：缩放曲线效果</li> <li><strong>options.speed</strong> [number] (default 1.2)：飞行速度</li> <li><strong>options.center</strong> ：飞行后的中心点，类似于初始化地图的center</li> <li><strong>options.zoom</strong> ：飞行后缩放级别</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  map<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">108.5</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    zoom<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    speed<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    curve<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token function">easing</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> t <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="jumpto-跳跃"><a href="#jumpto-跳跃" aria-hidden="true" class="header-anchor">#</a> jumpTo 跳跃</h3> <ul><li>地图移动的方法之一</li> <li>参数和flyTo一样，<strong>options</strong>和<strong>传递的其他属性</strong></li> <li><strong>options.center</strong> (LngLatLike) : 目的地中心。</li> <li><strong>options.zoom</strong> (number) : 目的地的缩放级别。</li> <li><strong>options.bearing</strong> (number) : 目的地的方位角（bearing，rotation），按照逆时针偏离正北方的度数计算。</li> <li><strong>options.pitch</strong> (number) : 目的地的倾斜度（pitch，tilt），单位为度。</li> <li><strong>options.around</strong> (LngLatLike) : zoom 指定之后，  around 将决定缩放中心（默认为地图中心）。</li></ul> <h3 id="easeto-动态转换"><a href="#easeto-动态转换" aria-hidden="true" class="header-anchor">#</a> easeTo 动态转换</h3> <ul><li>地图移动的方法之一，参数同上</li></ul> <h2 id="layer-和-source"><a href="#layer-和-source" aria-hidden="true" class="header-anchor">#</a> Layer 和 Source</h2> <ul><li>Layer是图层，Source是数据源</li> <li>Layer和Source需要相辅相成，一个负责界面呈现，一个是数据</li> <li>Source支持：vector、raster、geojson、image、video。
<ul><li>geojson 处理各种矢量类型，包括集合</li> <li>vector 主要解决矢量瓦片</li> <li>raster 解决目前常用的栅格化瓦片</li> <li>video 的加入使得功能更加的现代化</li> <li>mapbox在style里面，为source定义了一个type属性，来说明这些类型。</li></ul></li> <li>Layer分为：background、fill、line、symbol、raster、circle，除了background类型的layer不需要绑定source之外。其他的都需要有source。
<ul><li>fill 只负责填充</li> <li>line 只负责线条</li> <li>symbol 处理sprite图，文字等</li> <li>raster 只负责图片</li> <li>circle 负责点</li> <li>Filter 设置展示的过滤条件，定制化显示</li></ul></li></ul> <h3 id="添加-删除layer"><a href="#添加-删除layer" aria-hidden="true" class="header-anchor">#</a> 添加/删除Layer</h3> <ul><li><p>有这么一个需求，我输入一个经纬度或者一个别的什么条件来查到这个点在地图上的位置，并且根据这个区域的admincode或者别的什么条件圈出该区逇范围</p></li> <li><p>如下图，左边是效果，右边是该区域的数据，原地图是没有那个紫色的边框的，我们要查出来后给该区域添加上
</p><p><img src="/imgs/mapbox-addlayer-line-result.png" height="248"> <img src="/imgs/mapbox-addlayer-line-data.png" height="220"></p><p></p></li> <li><p>那么我么需要用到addLayer方法，添加layer，但是我们需要获取到底图的数据</p></li> <li><p>queryRenderedFeatures()，查询渲染后的功能信息，该返回一个GeoJSON Feature Object数据，表明满足查询参数的可见要素。<a href="https://www.mapbox.cn/mapbox-gl-js/api/#map#queryrenderedfeatures" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>我们使用该方法传递layerId，获取到我们要的数据</p></li> <li><p>开始添加layer，map.addLayer() 接收一个配置对象，配置对象规则如下</p> <ul><li>样式的layer属性将列出该样式中所有可用的图层。图层类型由 <em>type</em> 属性规定，且指定方式必须为 background, fill, line, symbol, raster, circle, fill-extrusion</li> <li>除了 background 类型的图层，其它每一个图层都需要参考一个数据源。 图层从数据源获取数据，选择性地筛选要素，然后定义为这些要素添加样式的方式。</li> <li>具体信息查看 <a href="https://www.mapbox.cn/mapbox-gl-js/style-spec/#layers" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><p>我们的代码最终如下</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">drawLine</span><span class="token punctuation">(</span><span class="token parameter">admincode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 添加前先删除之前的</span>
    <span class="token keyword">let</span> _layer <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token string">'data_town_polygon'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_layer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      map<span class="token punctuation">.</span><span class="token function">removeLayer</span><span class="token punctuation">(</span>_layer<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
      map<span class="token punctuation">.</span><span class="token function">removeSource</span><span class="token punctuation">(</span>_layer<span class="token punctuation">.</span>source<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// 唯一ID，不可重复</span>
      id<span class="token punctuation">:</span> <span class="token string">'data_town_polygon'</span><span class="token punctuation">,</span>
      <span class="token comment">// 我们是画线，所以选择line</span>
      type<span class="token punctuation">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
      source<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token string">'vector'</span><span class="token punctuation">,</span>
        tiles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'http://10.125.214.22:8080/data/town/{z}/{x}/{y}.pbf'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">'source-layer'</span><span class="token punctuation">:</span> <span class="token string">'town_polygon'</span><span class="token punctuation">,</span>
      <span class="token string">'layout'</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
        visibility<span class="token punctuation">:</span><span class="token string">'visible'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 定义layer的样式规则</span>
      <span class="token string">'paint'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'line-color'</span><span class="token punctuation">:</span> <span class="token string">'#4D2EA5'</span><span class="token punctuation">,</span>
        <span class="token string">'line-width'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">'line-opacity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token string">'case'</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token string">'boolean'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'feature-state'</span><span class="token punctuation">,</span> <span class="token string">'hover'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.6</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 定义过滤条件，这里是传递过来的admincode</span>
      filter<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'admincode'</span><span class="token punctuation">,</span> admincode<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="地图事件"><a href="#地图事件" aria-hidden="true" class="header-anchor">#</a> 地图事件</h2> <h3 id="on-load事件"><a href="#on-load事件" aria-hidden="true" class="header-anchor">#</a> on -&gt; load事件</h3> <ul><li>该事件一般用作地图渲染完毕处理一些事情</li></ul> <h3 id="on-click-事件"><a href="#on-click-事件" aria-hidden="true" class="header-anchor">#</a> on -&gt; click 事件</h3> <ul><li>鼠标单击事件，对原生的click做了很好的封装</li> <li>比如说我们可以，获取到经纬度，点信息，我们可以根据点信息获取feature信息</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 截取一段根据事件对象获取到的点信息来画地图</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">ev<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isMouseGet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> features<span class="token punctuation">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">queryRenderedFeatures</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>point<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> <span class="token string">'sss'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>features<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'未获取到该区域的数据'</span><span class="token punctuation">)</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawLine</span><span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">[</span><span class="token string">'admin_code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> areaInfo<span class="token punctuation">:</span> any <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        areaInfo<span class="token punctuation">[</span><span class="token function">toHump</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>info <span class="token operator">=</span> areaInfo
      <span class="token comment">// @ts-ignore</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">handleDialogOpen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>info<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="改变鼠标手型"><a href="#改变鼠标手型" aria-hidden="true" class="header-anchor">#</a> 改变鼠标手型</h3> <ul><li><em>map</em> 的实例有个 <em>getCanvas()</em> 方法可以获取到 <em>canvas</em> 地图上的 <em>canvas</em> 元素</li> <li>此时我们可以调用它的 <em>style.cursor</em> 为其赋值，便可以改变地图上的鼠标手型</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token string">'pointer'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>关于鼠标手型，可以看下<a href="http://www.hangge.com/blog/cache/detail_2065.html" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这里列出来所有的鼠标手型以及长什么样子</li></ul></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2019-07-31 8:30:41 晚上</span></div></footer> <!----> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bbd35a38.js" defer></script><script src="/assets/js/3.40b378a7.js" defer></script><script src="/assets/js/1.f41db50d.js" defer></script><script src="/assets/js/17.5aea2979.js" defer></script>
  </body>
</html>
