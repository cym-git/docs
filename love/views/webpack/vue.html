<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue 项目的配置 | chengyuming</title>
    <meta name="description" content="Today, have you studied yet?">
    <link rel="icon" href="/imgs/oops.png">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.0c9ad33d.css" as="style"><link rel="preload" href="/assets/js/app.bbd35a38.js" as="script"><link rel="preload" href="/assets/js/3.40b378a7.js" as="script"><link rel="preload" href="/assets/js/1.f41db50d.js" as="script"><link rel="preload" href="/assets/js/20.7a532207.js" as="script"><link rel="prefetch" href="/assets/js/10.f4f7f506.js"><link rel="prefetch" href="/assets/js/11.d125c012.js"><link rel="prefetch" href="/assets/js/12.37a8c984.js"><link rel="prefetch" href="/assets/js/13.5805149a.js"><link rel="prefetch" href="/assets/js/14.85e0680a.js"><link rel="prefetch" href="/assets/js/15.9191ecf2.js"><link rel="prefetch" href="/assets/js/16.9ebb5559.js"><link rel="prefetch" href="/assets/js/17.5aea2979.js"><link rel="prefetch" href="/assets/js/18.696ad47e.js"><link rel="prefetch" href="/assets/js/19.a079e272.js"><link rel="prefetch" href="/assets/js/21.46f02a18.js"><link rel="prefetch" href="/assets/js/4.8fbbe4ba.js"><link rel="prefetch" href="/assets/js/5.59272d5a.js"><link rel="prefetch" href="/assets/js/6.4f95ab1b.js"><link rel="prefetch" href="/assets/js/7.81114dda.js"><link rel="prefetch" href="/assets/js/8.a6fed93d.js"><link rel="prefetch" href="/assets/js/9.06ed8ddc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0c9ad33d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.jpg" alt="chengyuming" class="logo"> <span class="site-name">chengyuming</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      大前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/webpack/index.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack简介
</a></li><li class="dropdown-item"><!----> <a href="/views/webpack/vue.html" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  从0搭建vue
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/index.html" class="nav-link"><i class="iconfont undefined"></i>
  node简介
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/fs.html" class="nav-link"><i class="iconfont undefined"></i>
  fs文件系统
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/backend/mysql.html" class="nav-link"><i class="iconfont undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/nginx/index.html" class="nav-link"><i class="iconfont undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/visualization/mapbox.html" class="nav-link"><i class="iconfont undefined"></i>
  mapbox
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-three"></i>
      基础
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/basis/javascript.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/basis/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li></ul></div></div> <a href="https://github.com/cym-git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      大前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/webpack/index.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack简介
</a></li><li class="dropdown-item"><!----> <a href="/views/webpack/vue.html" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  从0搭建vue
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/index.html" class="nav-link"><i class="iconfont undefined"></i>
  node简介
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/node/fs.html" class="nav-link"><i class="iconfont undefined"></i>
  fs文件系统
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/backend/mysql.html" class="nav-link"><i class="iconfont undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/nginx/index.html" class="nav-link"><i class="iconfont undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/views/big-front-end/visualization/mapbox.html" class="nav-link"><i class="iconfont undefined"></i>
  mapbox
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-three"></i>
      基础
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/basis/javascript.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/basis/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li></ul></div></div> <a href="https://github.com/cym-git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue 项目的配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/webpack/vue.html#从-0-开始搭建-vue-项目" class="sidebar-link">从 0 开始搭建 vue 项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/webpack/vue.html#一、项目结构" class="sidebar-link">一、项目结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/webpack/vue.html#二、简单配置-webpack" class="sidebar-link">二、简单配置 webpack</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/webpack/vue.html#三、开始配置-vue" class="sidebar-link">三、开始配置 vue</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/webpack/vue.html#四、编译-js" class="sidebar-link">四、编译 js</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/webpack/vue.html#五、项目优化" class="sidebar-link">五、项目优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#分离-css" class="sidebar-link">分离 css</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#分离不常变化的文件" class="sidebar-link">分离不常变化的文件</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#压缩-js-和压缩-css" class="sidebar-link">压缩 js 和压缩 css</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#去除无用的-css" class="sidebar-link">去除无用的 css</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#开启-gzip" class="sidebar-link">开启 gzip</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#显示打包进度和打包时间" class="sidebar-link">显示打包进度和打包时间</a></li><li class="sidebar-sub-header"><a href="/views/webpack/vue.html#友好的错误提示" class="sidebar-link">友好的错误提示</a></li></ul></li><li><a href="/views/webpack/vue.html#六、source-map" class="sidebar-link">六、Source Map</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>vue 项目的配置</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>chengyuming</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2019-7-23</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      webpack
    </span><span class="tag-item" data-v-b53d65a4>
      vue
    </span></i></div></div> <div class="content__default"><h1 id="vue-项目的配置"><a href="#vue-项目的配置" aria-hidden="true" class="header-anchor">#</a> vue 项目的配置</h1> <h2 id="从-0-开始搭建-vue-项目"><a href="#从-0-开始搭建-vue-项目" aria-hidden="true" class="header-anchor">#</a> 从 0 开始搭建 vue 项目</h2> <p><a href="empty">webpack</a>打包部署 js 项目从以下几个方面考虑：</p> <ul><li>js 的处理：转换 ES6 代码，解决浏览器兼容问题</li> <li>css 的处理：编译 css，自动添加前缀，抽取 css 到独立文件</li> <li>html 的处理：复制并压缩 html 文件</li> <li>dist 的清理：打包前清理源目录文件</li> <li>assets 的处理：静态资源处理</li> <li>server 的启用：development 模式下启动服务器并实时刷新</li></ul> <h2 id="一、项目结构"><a href="#一、项目结构" aria-hidden="true" class="header-anchor">#</a> 一、项目结构</h2> <div class="tip custom-block"><p class="custom-block-title">项目结构</p> <p>我们按照 vue-cli 的目录结构来新建一些目录，然后 webpack 做相应的配置，打开控制台</p></div> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token builtin class-name">cd</span> 切换到你要把项目新建到的地方
  <span class="token comment"># 新建项目目录</span>
  <span class="token function">mkdir</span> webpack-pit <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> webpack-pit
  <span class="token comment"># 初始化项目</span>
  <span class="token function">npm</span> init -y
  <span class="token comment"># 新建基本结构</span>
  <span class="token function">mkdir</span> src public
  <span class="token comment"># 新建基本配置文件</span>
  <span class="token function">touch</span> webpack.config.js babel.config.js postcss.config.js .gitignore
  <span class="token comment"># 打开src目录，新建main.js，作为项目的主入口</span>
  <span class="token builtin class-name">cd</span> src <span class="token operator">&amp;&amp;</span> <span class="token function">touch</span> main.js
  <span class="token comment"># src作为我们编写的主文件，模拟vue的项目目录新建以下文件及文件夹</span>
  <span class="token function">mkdir</span> assets components styles views
  <span class="token comment"># 最终生成以下目录结构</span>
  ├── public
  │   ├── favicon.ico
  │   └── index.html      <span class="token comment"># html 模板</span>
  ├── src
  │   ├── assets          <span class="token comment"># 静态资源</span>
  │   ├── views
  │   ├── components      <span class="token comment"># 组件</span>
  │   │   └── App.vue
  │   ├── styles
  │   │   └── index.scss
  │   ├── main.js         <span class="token comment"># 入口文件</span>
  │   └── App.vue
  ├── babel.config.js     <span class="token comment"># babel7配置文件</span>
  ├── package-lock.json   <span class="token comment"># npm包锁</span>
  ├── package.json        <span class="token comment"># 项目配置文件</span>
  ├── postcss.config.js   <span class="token comment"># css配置文件</span>
  └── webpack.config.js   <span class="token comment"># 项目打包机主文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="二、简单配置-webpack"><a href="#二、简单配置-webpack" aria-hidden="true" class="header-anchor">#</a> 二、简单配置 webpack</h2> <div class="tip custom-block"><p class="custom-block-title">简单配置 webpack</p> <p>简单配置下 webpack，先把项目跑起来，下载 webpack 依赖</p></div> <ul><li><p>首先我们需要用到 webpack、webpack-cli、webpack-dev-server，那么我们执行以下命令</p> <ul><li>webpack 用来打包项目，webpack-dev-server 用来本地开发，webpack-cli 必不可少</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> webpack webpack-cli webpack-dev-server --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>我们要编译 html，需要用到 html-webpack-plugin 插件，每次打包我们需要在 build 之前先删除之前打包后的文件因为 hash 的存在会导致文件冲突，所以我们安装以下两个插件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> html-webpack-plugin html-loader clean-webpack-plugin --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>html-loader 是 babel 的一个 loader 用来编译 html</p></li> <li><p>clean-webpack-plugin 用来对打包之前的删除操作，因为新版本的原因，引入方式有点不一样</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>webpack 处理 html、css、js，就会处理路径，我们会用到 path 模块，一般会写一个 resolve 方法来处理路径</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  yarn add path <span class="token operator">--</span>save<span class="token operator">-</span>dev
  <span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">dir</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>webpack 必须配置的几项，entry、output</p> <ul><li>entry 顾名思义配置文件主入口的，他的配置方式多种多样，详细了解 webpack 的介绍 <a href="/webpack/#一、-entry-入口配置">传送门</a></li> <li>我们先简单的配置以下，使 js 和 html 耦合到一起，entry 我们选对象语法</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>output 就是对象语法，必要的有两个配置项，path、filename 还有一个可有可无 publicPath 打包后静态资源文件夹的目录</li> <li>path 是打包后的目录，若没有这个目录 webpack 会自己新建，filename 是打包后的文件名字，语法如下</li> <li>hash 介绍看 webpack 的介绍 <a href="/webpack/#四、hash、-chunkhash和contenthash有什么不同？">传送门</a></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'love'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   filename<span class="token punctuation">:</span> <span class="token string">'js/[name].[hash].js'</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>配置开发环境下的 node 服务器，devserver</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 服务器根目录</span>
    compress<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">// 开启gzip</span>
    host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    port<span class="token punctuation">:</span> <span class="token string">'8880'</span><span class="token punctuation">,</span>
    open<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                     <span class="token comment">// 自动打开网站</span>
    hot<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                      <span class="token comment">// 开启热加载</span>
    inline<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                   <span class="token comment">// 热加载方式</span>
    overlay<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      warnings<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      errors<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>配置 plugins，先介绍两个插件 html-webpack-plugin 和 clean-webpack-plugin，配置如下</li> <li>HtmlWebpackPlugin 详细配置看这里 <a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>CleanWebpackPlugin 详细配置看这里 <a href="https://github.com/johnagan/clean-webpack-plugin" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-javascript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-javascript"><code>  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 处理html</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'public/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 源模板文件，可以是ejs、pug等模板文件</span>
      filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>                  <span class="token comment">// 输出的文件</span>
      title<span class="token punctuation">:</span> <span class="token string">'webpack构建项目'</span><span class="token punctuation">,</span>                 <span class="token comment">// html的title</span>
      inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                            <span class="token comment">// 是否动态注入</span>
      hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                              <span class="token comment">// 开启hash</span>
      favicon<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'public/favicon.ico'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// 推荐你不要设置，有坑</span>
      chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'app'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                         <span class="token comment">// 注入的脚本，跟entry里面要对应上</span>
      showErrors<span class="token punctuation">:</span> <span class="token boolean">true</span>                         <span class="token comment">// 报错了是否展示</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">不推荐设置 chunks</p> <p>项目中之前设置了 chunks 打包后对应某个模块，但是我们用到了分离插件，导致分离后的东西，动态的我们不确定名字，导致不去加载那个文件，导致页面不渲染，这个属性不设置，也不会不错，他会动态的都给你加上去</p></div></li> <li><p>最后我们修改下 package.json 的启动脚本，然后我们可以在 main.js 下写一些执行脚本，就可以看到效果了</p></li> <li><p>--mode development 设置 webpack 运行时的环境为 development，--progress 不用说了吧</p></li></ul> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code>  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --mode development --progress&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode production --progress&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="三、开始配置-vue"><a href="#三、开始配置-vue" aria-hidden="true" class="header-anchor">#</a> 三、开始配置 vue</h2> <div class="tip custom-block"><p class="custom-block-title">配置 vue</p> <p>配置 vue，需要下载 vue 核心的插件 vue-loader vue-template-compiler，以及我们将要用到的 sass 的配置</p></div> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> vue --save
  <span class="token function">yarn</span> <span class="token function">add</span> vue-loader vue-template-compiler --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>配置 vue
<ul><li>vue 核心插件下载完之后在 vue-loader 下面的 lib 里面有他的插件配置，我们取出来就可以直接用</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-loader/lib/plugin'</span><span class="token punctuation">)</span>
  <span class="token operator">...</span>省略上万行代码
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>然后我们配置 module，配置 vue 文件怎么执行</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
      loader<span class="token punctuation">:</span> <span class="token string">'vue-loader'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>然后我们在相应的地方写上我们改写的代码，此时就可以运行代码了
<ul><li>在 public 下面的 index.html 里面写下</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>在 main.js 里面引入 vue，并简单配置下 vue</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">import</span> Vue form <span class="token string">'vue'</span>
  <span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
  <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">render</span><span class="token punctuation">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>在 App.vue 里面写下</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    hello world
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'app'</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li>此时 vue 最基本的功能就配置完成了</li></ul></li> <li>接下来我们配置 css 预编译 scss，还有 css 的兼容那个 postcss 自动填充浏览器前缀
<ul><li>css loader 介绍请看这里 <a href="/webpack/#六、webpack处理css的一些介绍">传送门</a></li> <li>首先需要几个插件 style-loader css-loader postcss-loader scss-loader</li> <li>webpack 的模块的执行顺序是倒着来的，我们也要倒着来配置</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> node-sass sass-loader postcss-loader style-loader css-loader --save-dev
  <span class="token function">yarn</span> <span class="token function">add</span> --dev autoprefixer
  <span class="token comment"># css loader配置</span>
  <span class="token punctuation">{</span>
    test: /<span class="token punctuation">\</span>.<span class="token punctuation">(</span>sa<span class="token operator">|</span>sc<span class="token operator">|</span>c<span class="token punctuation">)</span>ss$/,
    loader: <span class="token punctuation">[</span><span class="token string">'style-loader'</span>, <span class="token string">'css-loader'</span>, <span class="token string">'postcss-loader'</span>, <span class="token string">'sass-loader'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>postcss 是 css 后处理器 postcss.config.js 的配置如下</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    autoprefixer<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li>可能会用到对一些文件的打包，比如说图片转 base64，解析字体，我们会用到 file-loader<div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  yarn add file<span class="token operator">-</span>loader <span class="token operator">--</span>save<span class="token operator">-</span>dev
  # 配置如下
  <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpg|gif)$/</span><span class="token punctuation">,</span>
    loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      limit<span class="token punctuation">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
      <span class="token comment">// 分离图片至imgs文件夹</span>
      name<span class="token punctuation">:</span> <span class="token string">&quot;imgs/[name].[ext]&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li>附上源码地址：<a href="https://gitee.com/cym_git/webpack-pit.git" target="_blank" rel="noopener noreferrer">https://gitee.com/cym_git/webpack-pit.git<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 请选择 basic 分支</li> <li>基础篇完结</li></ul> <h2 id="四、编译-js"><a href="#四、编译-js" aria-hidden="true" class="header-anchor">#</a> 四、编译 js</h2> <div class="tip custom-block"><p class="custom-block-title">编译 js</p> <p>忘了重要的一项，忘记了编译 js 了，我说怎么缺点什么呢</p></div> <ul><li>编译 js 我选择了 env 插件，为什么？<a href="https://zhuanlan.zhihu.com/p/29506685" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>而且我试了用了 @babel/preset-es2015 但是还是一直报找不到这个模块
<p align="center"><img src="/imgs/error-@babelpreset-es2015.png"></p></li> <li>最终选择了 @babel/preset-env 插件</li></ul> <div class="language-conf line-numbers-mode"><pre class="language-text"><code>  yarn add --save-dev @babel/core @babel/preset-env babel-loader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>babel-loader 默认下载就是 babel7 的插件，我们选择了 babel7 的插件，因为 babel 已经是最稳定的插件了</li> <li>用了 babel7 之后 babel 配置文件是 babel.config.js 和.babelrc 都无所谓了，不过.babelrc 要求必须是严格的 JSON 语法</li> <li>当我们配置了 babel.config.js 之后还是报了一个错
<p align="center"><img src="/imgs/error-@babelpreset-env.png"></p></li> <li>那我们按照他的提示下载并且配置该插件就好</li></ul> <div class="language-conf line-numbers-mode"><pre class="language-text"><code>  yarn add @babel/plugin-syntax-dynamic-import
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>并附上 babel.config.js 的配置</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/plugin-syntax-dynamic-import'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>如果您喜欢用.babelrc 配置的话也是可以，下面是.babelrc 的配置</li></ul> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code>  <span class="token punctuation">{</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>编译 beble 的 loader 配置如下，我们只编译 src 目录下的文件，减少文件搜索范围</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
    loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
    include<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'node_modules/webpack-dev-server/client'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="五、项目优化"><a href="#五、项目优化" aria-hidden="true" class="header-anchor">#</a> 五、项目优化</h2> <h3 id="分离-css"><a href="#分离-css" aria-hidden="true" class="header-anchor">#</a> 分离 css</h3> <ul><li>插件是 mini-css-extract-plugin，该插件必须是 webpack4.0 以上才支持</li></ul> <div class="language-conf line-numbers-mode"><pre class="language-text"><code>  # 下载插件
  yarn add mini-css-extract-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>插件介绍：
<ul><li>在 plugins 数组中直接 new MiniCSSExtractPlugin 就可以，它接受一个 options 作为一个参数</li> <li>filename 和 chunkFilename，这两项都是可选的，类似于 webpackOptions.output</li> <li>简单配置如下 <a href="https://webpack.js.org/plugins/mini-css-extract-plugin/" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  filename<span class="token punctuation">:</span> <span class="token string">'css/[name].[hash].css'</span><span class="token punctuation">,</span>
  chunkFilename<span class="token punctuation">:</span> <span class="token string">'css/[id].[hash].css'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>配置完后，需要修改 module 里面配置 css 的参数，修改为以下配置</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.(sa|sc|c)ss$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// publicPath: '../',</span>
          reloadAll<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
      <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
      <span class="token string">'sass-loader'</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ul> <h3 id="分离不常变化的文件"><a href="#分离不常变化的文件" aria-hidden="true" class="header-anchor">#</a> 分离不常变化的文件</h3> <ul><li>node_modules 下面的模块，引用别人的库，我们是不需要编译，所以我们把它们分离出来，这是我们需要配置 optimization 配置项</li> <li>这么配置以下，会看到项目下面会打包出一个 vendor.js 文件</li> <li>具体配置参照 <a href="https://imweb.io/topic/5b66dd601402769b60847149" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 分离chunks</span>
  splitChunks<span class="token punctuation">:</span> isProduction
    <span class="token operator">?</span> <span class="token punctuation">{</span>
        chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
        cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          vendor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'vendor'</span><span class="token punctuation">,</span>
            test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
            priority<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            chunks<span class="token punctuation">:</span> <span class="token string">'initial'</span> <span class="token comment">// 只打包初始时依赖的第三方</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>如果项目使用包模块多的话，我们可以把大点的包都分离出来，cacheGroup 就是配置的关键，可以卓个分离分离</li> <li>比如说你想把 vue、vue-router 分离出来，或者你用了 element、echarts 因为打包后单个包太大，你想要分割代码，那就配置 cacheGroup</li> <li>它是 webpack 自带的插件，不需要引入直接就可以用，简单配置如下</li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
    cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      libs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'chunk-libs'</span><span class="token punctuation">,</span>
        test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
        priority<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        chunks<span class="token punctuation">:</span> <span class="token string">'initial'</span> <span class="token comment">// 只打包初始时依赖的第三方</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      vue<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'vue'</span><span class="token punctuation">,</span>
        test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]vue[\\/]/</span><span class="token punctuation">,</span>
        priority<span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 单独分离vue-router</span>
      <span class="token comment">// vueRouter: {</span>
      <span class="token comment">//   name: 'vue-router',</span>
      <span class="token comment">//   test: /[\\/]node_modules[\\/]vue-router[\\/]/,</span>
      <span class="token comment">//   priority: 12,</span>
      <span class="token comment">// }</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="压缩-js-和压缩-css"><a href="#压缩-js-和压缩-css" aria-hidden="true" class="header-anchor">#</a> 压缩 js 和压缩 css</h3> <ul><li>需要两个插件 optimize-css-assets-webpack-plugin 和 uglifyjs-webpack-plugin</li></ul> <div class="language-conf line-numbers-mode"><pre class="language-text"><code>  yarn add --save-dev uglifyjs-webpack-plugin
  yarn add optimize-css-assets-webpack-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>压缩文件出现的情况下都在生产环境下，开发环境是不需要的，所以我们可以下判断</li> <li>OptimizeCSSAssetsWebpackPlugin 插件基本不需要配置，直接实例化传入一个空的 options 就可以</li> <li>UgligyjsWebpackPlugin 有个坑，配置完毕后，项目打包报错了
<p align="center"><img src="/imgs/error-uglifyjs.png"></p> <ul><li>他的意思说配置warnings配置出错，看下之前的配置</li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code>  minimizer<span class="token punctuation">:</span> isProduction
    <span class="token operator">?</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">UgligyjsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          uglifyOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              warnings<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
              drop_debugger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              collapse_vars<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 内嵌定义了但是只用到一次的变量</span>
              reduce_vars<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 提取出出现多次但是没有定义成变量去引用的静态值</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启缓存</span>
            parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 平行压缩</span>
            sourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>查找原因说插件升级造成的，配置应该给提出来 <a href="https://stackoverflow.com/questions/55989693/warnings-is-not-a-supported-option-error-from-uglifyjs/55998303#55998303" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>那么我们修改为以下配置，此时不再报错</li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code>  minimizer<span class="token punctuation">:</span> isProduction
    <span class="token operator">?</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">UgligyjsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          uglifyOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              drop_debugger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            warnings<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启缓存</span>
            parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 平行压缩</span>
            sourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul> <h3 id="去除无用的-css"><a href="#去除无用的-css" aria-hidden="true" class="header-anchor">#</a> 去除无用的 css</h3> <ul><li>需要用到两个插件 PurgecssPlugin 和 glob</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> glob-all --save-dev
  <span class="token function">yarn</span> <span class="token function">add</span> purgecss-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>简单配置如下</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">new</span> <span class="token class-name">PurgecssPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    paths<span class="token punctuation">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./**/*.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/**/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="开启-gzip"><a href="#开启-gzip" aria-hidden="true" class="header-anchor">#</a> 开启 gzip</h3> <ul><li>需要用到插件 CompressionWebpackPlugin</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  <span class="token function">yarn</span> <span class="token function">add</span> -D compression-webpack-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>简单配置入下，这样配置下打包后项目就会生成 gz 压缩包</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    algorithm<span class="token punctuation">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span>
    test<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'\\.('</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')$'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    threshold<span class="token punctuation">:</span> <span class="token number">10240</span><span class="token punctuation">,</span>
    minRatio<span class="token punctuation">:</span> <span class="token number">0.8</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="显示打包进度和打包时间"><a href="#显示打包进度和打包时间" aria-hidden="true" class="header-anchor">#</a> 显示打包进度和打包时间</h3> <ul><li>需要用到两个插件 progress-bar-webpack-plugin chalk</li> <li><a href="https://www.npmjs.com/package/progress-bar-webpack-plugin" target="_blank" rel="noopener noreferrer">ProgressBarPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是用来配置进度条的，<a href="https://www.npmjs.com/package/chalk" target="_blank" rel="noopener noreferrer">chalk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是用来定义展示的颜色的</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 打包时间</span>
  <span class="token keyword">new</span> <span class="token class-name">ProgressBarPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    format<span class="token punctuation">:</span> <span class="token string">'  编译进度：[:bar] '</span> <span class="token operator">+</span> chalk<span class="token punctuation">.</span>green<span class="token punctuation">.</span><span class="token function">bold</span><span class="token punctuation">(</span><span class="token string">':percent'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' (已用时 :elapsed 秒)'</span><span class="token punctuation">,</span>
    clear<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="友好的错误提示"><a href="#友好的错误提示" aria-hidden="true" class="header-anchor">#</a> 友好的错误提示</h3> <ul><li>在 webpack 中编译过程中终端会输出很多信息的，看着很别扭，此时可以用到一个插件来很友好的显示</li> <li>在开发环境下展示的 log 我们完全可以把 <strong>devServer.quiet</strong> 设置为 <strong>true</strong>，此时整个世界都安静了</li> <li>模拟 vue-cli 中编译过程中输出的信息，我们用到 friendly-errors-webpack-plugin 插件</li> <li>经测试，貌似只对开发环境管用，那么我们就模拟下 vue-cli 的展示</li> <li>在 plugins 添加一下代码 <a href="https://blog.csdn.net/kai_vin/article/details/89025966" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    compilationSuccessInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      messages<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        App running at:
        - Local:   </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">hex</span><span class="token punctuation">(</span><span class="token string">'#66D9EF'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'http://localhost:'</span> <span class="token operator">+</span> <span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
        - Network: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">hex</span><span class="token punctuation">(</span><span class="token string">'#66D9EF'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'http://'</span> <span class="token operator">+</span> networkIp <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      clearConsole<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">onErrors</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">severity<span class="token punctuation">,</span> errors</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>severity <span class="token operator">!==</span> <span class="token string">'error'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
        <span class="token keyword">const</span> error <span class="token operator">=</span> errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">const</span> filename <span class="token operator">=</span> error<span class="token punctuation">.</span>file <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        notifier<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token punctuation">:</span> packageConfig<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          message<span class="token punctuation">:</span> severity <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> error<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          subtitle<span class="token punctuation">:</span> filename <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">,</span>
          <span class="token comment">// icon: path.join(__dirname, 'logo.png')</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li>networkIp 是我们自己编写的一个利用 os 模块获取本机 ip 的方法，具体实现如下</li> <li>获取 networkInterfaces 对象，里面有 ip 的各种格式，筛选出我们要的那个就可以了</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interfaces <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">networkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getNetworkIp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> IpAddress <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> devName <span class="token keyword">in</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> iface <span class="token operator">=</span> interfaces<span class="token punctuation">[</span>devName<span class="token punctuation">]</span>
    iface<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">ipInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        ipInfo<span class="token punctuation">.</span>family <span class="token operator">===</span> <span class="token string">'IPv4'</span> <span class="token operator">&amp;&amp;</span>
        ipInfo<span class="token punctuation">.</span>address <span class="token operator">!==</span> <span class="token string">'127.0.0.1'</span> <span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span>ipInfo<span class="token punctuation">.</span>internal
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        IpAddress <span class="token operator">=</span> ipInfo<span class="token punctuation">.</span>address
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> IpAddress
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> getNetworkIp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>最终实现的效果如下所示</li></ul> <p align="center"><img src="/imgs/dev-error-info.png"></p> <h2 id="六、source-map"><a href="#六、source-map" aria-hidden="true" class="header-anchor">#</a> 六、Source Map</h2> <div class="tip custom-block"><p class="custom-block-title">为什么要用 source maps</p> <p>因为 webpack 对源代码进行打包后，会对源代码进行压缩、精简、甚至变量名替换，在浏览器中，无法对代码逐行打断点进行调试，所有需要使用 source maps 进行调试，它使得我们在浏览器中可以看到源代码，进而逐行打断点调试。</p></div> <ul><li>使用方法很简单，只需要在配置中添加 devtool 属性，赋值一个字符串或者布尔值即可 <a href="https://www.webpackjs.com/configuration/devtool/" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>使用 inline-source-map 不会对生产环境造成影响</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  devtool<span class="token punctuation">:</span> <span class="token string">'inline-source-map'</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>到此告一段落了，项目地址还是原来的地址，但是分支换成了 develop <a href="https://gitee.com/cym_git/webpack-pit.git" target="_blank" rel="noopener noreferrer">传送门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>🎉 💯</p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2019-07-31 8:30:41 晚上</span></div></footer> <!----> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bbd35a38.js" defer></script><script src="/assets/js/3.40b378a7.js" defer></script><script src="/assets/js/1.f41db50d.js" defer></script><script src="/assets/js/20.7a532207.js" defer></script>
  </body>
</html>
